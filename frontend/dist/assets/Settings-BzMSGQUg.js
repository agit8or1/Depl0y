import{_ as Hs,c as l,o as n,a as e,d as c,t as i,m as Ps,w as b,e as p,v as g,b as f,B as M,q as es,A as As,x as Is,r,k as Ts,l as m}from"./index-DpP9cWht.js";const Fs={name:"Settings",setup(){const u=Is(),s=r(null),y=r(null),t=r(!1),H=r(!1),S=r(!1),w=r(!1),o=r(null),V=r(""),ts=r(null),O=r(!1),os=r(100),P=r(null),R=r(!1),_=r(!1),us=r(!1),as=r(!1),A=r(""),L=r(!1),I=r(null),h=r(null),q=r(null),D=r(!1),ls=r(!1),T=r(""),N=r(!1),F=r(null),x=r(null),ns=r(null),B=r(!1),G=r(!1),C=r(null),Y=r(null),K=r(null),Q=r(!1),rs=r(!1),W=r(""),z=r(!1),j=r(null),J=r(null),X=r(null),is=r(!1),E=r({username:"",email:""}),k=r({current_password:"",new_password:"",confirm_password:""}),U=async()=>{try{const a=await m.auth.getMe();y.value=a.data,E.value.username=y.value.username,E.value.email=y.value.email}catch(a){console.error("Failed to fetch user:",a)}},cs=async()=>{try{const a=await m.dashboard.getStats();s.value=a.data}catch(a){console.error("Failed to fetch system info:",a)}},vs=async()=>{t.value=!0;try{await m.users.update(y.value.id,{email:E.value.email}),u.success("Profile updated successfully"),await U()}catch(a){console.error("Failed to update profile:",a)}finally{t.value=!1}},ms=async()=>{if(k.value.new_password!==k.value.confirm_password){u.error("New passwords do not match");return}H.value=!0;try{await m.users.changePassword({current_password:k.value.current_password,new_password:k.value.new_password}),u.success("Password changed successfully"),k.value={current_password:"",new_password:"",confirm_password:""}}catch(a){console.error("Failed to change password:",a)}finally{H.value=!1}},fs=async()=>{S.value=!0;try{const a=await m.auth.setupTOTP();o.value=a.data,w.value=!0}catch(a){console.error("Failed to setup TOTP:",a)}finally{S.value=!1}},ps=async()=>{try{await m.auth.verifyTOTP(V.value),u.success("2FA enabled successfully"),w.value=!1,V.value="",await U()}catch(a){u.error("Invalid code. Please try again."),console.error("Failed to verify TOTP:",a)}},bs=async()=>{const a=prompt("Enter your 6-digit 2FA code to disable:");if(a){S.value=!0;try{await m.auth.disableTOTP(a),u.success("2FA disabled successfully"),await U()}catch(v){u.error("Failed to disable 2FA. Check your code."),console.error("Failed to disable TOTP:",v)}finally{S.value=!1}}},gs=a=>({admin:"danger",operator:"warning",viewer:"info"})[a]||"info",ys=async()=>{O.value=!0;try{const a=await m.logs.getBackendLogs(os.value);ts.value=a.data.logs}catch(a){console.error("Failed to fetch logs:",a),u.error("Failed to load backend logs")}finally{O.value=!1}},Z=async()=>{R.value=!0;try{const a=await m.cloudImages.checkSSHStatus();P.value=a.data.configured,P.value?u.success("SSH access is configured!"):u.warning("SSH access not configured")}catch(a){console.error("Failed to check SSH status:",a),P.value=!1}finally{R.value=!1}},Ss=()=>{navigator.clipboard.writeText("sudo /tmp/enable_cloud_images.sh"),_.value=!0,u.success("Command copied to clipboard!"),setTimeout(()=>{_.value=!1},2e3)},ws=async()=>{var a,v;if(!A.value){u.error("Please enter your Proxmox password");return}L.value=!0,I.value=null,h.value=null;try{const d=await m.setup.enableCloudImages(A.value);d.data.already_configured?(h.value=d.data.message,u.success("Cloud images already enabled!")):(h.value=d.data.message,u.success("Cloud images enabled successfully!")),A.value="",setTimeout(async()=>{await Z(),as.value=!1,h.value=null},2e3)}catch(d){console.error("Failed to enable cloud images:",d),I.value=((v=(a=d.response)==null?void 0:a.data)==null?void 0:v.detail)||"Failed to enable cloud images. Please check your password and try again.",u.error("Setup failed: "+I.value)}finally{L.value=!1}},$=async()=>{D.value=!0;try{const a=await m.cloudImages.checkSSHStatus();q.value=a.data.configured}catch(a){console.error("Failed to check cluster SSH status:",a),q.value=!1}finally{D.value=!1}},ks=async()=>{var a,v;if(!T.value){u.error("Please enter your Proxmox password");return}N.value=!0,F.value=null,x.value=null;try{const d=await m.setup.enableClusterSSH(T.value);d.data.already_configured?(x.value=d.data.message,u.success("Inter-node SSH already enabled!")):(x.value=d.data.message,u.success("Inter-node SSH enabled successfully!")),T.value="",setTimeout(()=>{ls.value=!1,x.value=null,$()},2e3)}catch(d){console.error("Failed to enable inter-node SSH:",d),F.value=((v=(a=d.response)==null?void 0:a.data)==null?void 0:v.detail)||"Failed to enable inter-node SSH. Please check your password and try again.",u.error("Setup failed: "+F.value)}finally{N.value=!1}},ds=async()=>{var a,v;B.value=!0,C.value=null;try{const d=await m.systemUpdates.check();ns.value=d.data,d.data.update_available?u.info("Update available!"):u.success("You're up to date!")}catch(d){console.error("Failed to check for updates:",d),C.value=((v=(a=d.response)==null?void 0:a.data)==null?void 0:v.detail)||"Failed to check for updates",u.error("Failed to check for updates")}finally{B.value=!1}},hs=async()=>{var a,v;if(confirm("This will update Depl0y and restart the service. Continue?")){G.value=!0,C.value=null,Y.value=null;try{const d=await m.systemUpdates.apply();Y.value=d.data.message,u.success("Update started! Service will restart shortly."),setTimeout(()=>{u.info("Reloading page in 20 seconds..."),setTimeout(()=>{window.location.reload()},2e4)},5e3)}catch(d){console.error("Failed to apply update:",d),C.value=((v=(a=d.response)==null?void 0:a.data)==null?void 0:v.detail)||"Failed to apply update",u.error("Failed to apply update")}finally{G.value=!1}}},ss=async()=>{var a,v;Q.value=!0,X.value=null;try{const d=await m.ha.checkStatus();K.value=d.data}catch(d){console.error("Failed to check HA status:",d),X.value=((v=(a=d.response)==null?void 0:a.data)==null?void 0:v.detail)||"Failed to check HA status",K.value={enabled:!1,protected_vms:0}}finally{Q.value=!1}},xs=async()=>{var a,v;z.value=!0,j.value=null,J.value=null;try{const d=await m.ha.enable({proxmox_password:W.value});J.value=d.data.message||"High Availability enabled successfully!",u.success("High Availability enabled!"),setTimeout(()=>{rs.value=!1,W.value="",ss()},2e3)}catch(d){console.error("Failed to enable HA:",d),j.value=((v=(a=d.response)==null?void 0:a.data)==null?void 0:v.detail)||"Failed to enable HA",u.error("Failed to enable High Availability")}finally{z.value=!1}},Cs=()=>{is.value=!0};return Ts(()=>{U(),cs(),Z(),$(),ds(),ss()}),{systemInfo:s,user:y,profileForm:E,passwordForm:k,updatingProfile:t,changingPassword:H,totp_loading:S,showTOTPModal:w,totpSetup:o,totpCode:V,backendLogs:ts,loadingLogs:O,logLines:os,sshStatus:P,checkingSSH:R,commandCopied:_,showSetupInstructions:us,showPasswordPrompt:as,proxmoxPassword:A,enablingCloudImages:L,setupError:I,setupSuccess:h,clusterSSHStatus:q,checkingClusterSSH:D,showClusterSSHPrompt:ls,clusterPassword:T,enablingClusterSSH:N,clusterSSHError:F,clusterSSHSuccess:x,checkClusterSSHStatus:$,updateProfile:vs,changePassword:ms,setupTOTP:fs,verifyTOTP:ps,disableTOTP:bs,getRoleBadge:gs,refreshLogs:ys,checkSSHStatus:Z,copyCommand:Ss,enableCloudImages:ws,enableClusterSSH:ks,updateInfo:ns,checkingUpdates:B,applyingUpdate:G,updateError:C,updateSuccess:Y,checkForUpdates:ds,applyUpdate:hs,haStatus:K,checkingHA:Q,showHAPrompt:rs,haPassword:W,enablingHA:z,haSetupError:j,haSetupSuccess:J,haError:X,showHAManagement:is,checkHAStatus:ss,enableHA:xs,manageHAGroups:Cs}}},Es={class:"settings-page"},Us={class:"card"},Ms={class:"profile-content"},Vs={key:0,class:"profile-section"},Os={class:"profile-header"},Rs={class:"profile-avatar"},_s={class:"text-sm text-muted"},Ls={class:"profile-details"},qs={class:"form-group"},Ds={class:"form-group"},Ns=["disabled"],Bs={class:"form-group"},Gs={class:"form-group"},Ys={class:"form-group"},Ks=["disabled"],Qs={class:"totp-section"},Ws={key:0,class:"totp-enabled"},zs=["disabled"],js={key:1,class:"totp-disabled"},Js=["disabled"],Xs={class:"card"},Zs={class:"cloud-setup-content"},$s={key:0,class:"loading-message"},se={key:1,class:"success-box"},ee={key:2,class:"warning-box"},te={class:"action-buttons"},oe=["disabled"],ae={class:"command-box"},le={class:"action-buttons"},ne={class:"card"},re={class:"card-body"},ie={key:0,class:"loading-message"},de={key:1,class:"success-box"},ue={key:2,class:"warning-box"},ce={class:"action-buttons",style:{"margin-top":"1rem"}},ve=["disabled"],me={class:"card"},fe={class:"card-body"},pe={key:0,class:"loading-message"},be={key:1,class:"success-box"},ge={class:"text-sm text-muted"},ye={key:2,class:"warning-box"},Se={class:"action-buttons",style:{"margin-top":"1rem"}},we=["disabled"],ke={key:3,class:"error-message",style:{"margin-top":"1rem"}},he={class:"card"},xe={class:"card-body"},Ce={key:0,class:"info-box"},He={key:1,class:"info-box alert-danger"},Pe={key:2,class:"info-box"},Ae={key:0,class:"text-success"},Ie={key:1,class:"text-muted"},Te={key:3,class:"release-notes"},Fe={class:"action-buttons",style:{"margin-top":"1rem"}},Ee=["disabled"],Ue=["disabled"],Me={key:4,class:"error-message",style:{"margin-top":"1rem"}},Ve={key:5,class:"success-message",style:{"margin-top":"1rem"}},Oe={class:"modal-header"},Re={class:"modal-footer"},_e={class:"modal-header"},Le={class:"modal-body"},qe={class:"form-group"},De=["disabled"],Ne={key:0,class:"error-message"},Be={key:1,class:"success-message"},Ge={class:"modal-footer"},Ye=["disabled"],Ke=["disabled"],Qe={class:"modal-header"},We={class:"modal-body"},ze={key:0,class:"totp-setup"},je={class:"qr-code"},Je=["src"],Xe={class:"secret-code"},Ze={class:"form-group"},$e={class:"card"},st={class:"about-content"},et={class:"info-grid"},tt={class:"info-item"},ot={class:"info-value"},at={key:3,class:"card"},lt={class:"system-info"},nt={class:"info-row"},rt={class:"info-value"},it={class:"info-row"},dt={class:"info-value"},ut={class:"info-row"},ct={class:"info-value"},vt={key:4,class:"card"},mt={class:"card-header"},ft=["disabled"],pt={class:"logs-content"},bt={class:"logs-controls"},gt={class:"form-label"},yt={key:0,class:"logs-viewer"},St={class:"logs-text"},wt={key:1,class:"logs-empty"},kt={class:"modal-header"},ht={class:"modal-body"},xt={class:"form-group"},Ct=["disabled"],Ht={key:0,class:"error-message"},Pt={key:1,class:"success-message"},At={class:"modal-footer"},It=["disabled"],Tt=["disabled"],Ft={class:"modal-header"},Et={class:"modal-body"},Ut={class:"form-group",style:{"margin-top":"1rem"}},Mt=["disabled"],Vt={key:0,class:"error-message"},Ot={key:1,class:"success-message"},Rt={class:"modal-footer"},_t=["disabled"],Lt=["disabled"],qt={class:"modal-header"},Dt={class:"modal-footer"};function Nt(u,s,y,t,H,S){var w;return n(),l("div",Es,[e("div",Us,[s[67]||(s[67]=e("div",{class:"card-header"},[e("h3",null,"User Profile")],-1)),e("div",Ms,[t.user?(n(),l("div",Vs,[e("div",Os,[e("div",Rs,i(t.user.username.charAt(0).toUpperCase()),1),e("div",null,[e("h4",null,i(t.user.username),1),e("p",_s,i(t.user.email),1),e("span",{class:Ps(["badge","badge-"+t.getRoleBadge(t.user.role)])},i(t.user.role),3)])]),e("div",Ls,[s[64]||(s[64]=e("h5",{class:"subsection-title"},"Account Information",-1)),e("form",{onSubmit:s[2]||(s[2]=b((...o)=>t.updateProfile&&t.updateProfile(...o),["prevent"])),class:"profile-form"},[e("div",qs,[s[56]||(s[56]=e("label",{class:"form-label"},"Username",-1)),p(e("input",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.profileForm.username=o),class:"form-control",disabled:""},null,512),[[g,t.profileForm.username]]),s[57]||(s[57]=e("p",{class:"text-xs text-muted"},"Username cannot be changed",-1))]),e("div",Ds,[s[58]||(s[58]=e("label",{class:"form-label"},"Email Address",-1)),p(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.profileForm.email=o),type:"email",class:"form-control",required:""},null,512),[[g,t.profileForm.email]])]),e("button",{type:"submit",class:"btn btn-primary",disabled:t.updatingProfile},i(t.updatingProfile?"Updating...":"Update Profile"),9,Ns)],32),s[65]||(s[65]=e("h5",{class:"subsection-title",style:{"margin-top":"2rem"}},"Change Password",-1)),e("form",{onSubmit:s[6]||(s[6]=b((...o)=>t.changePassword&&t.changePassword(...o),["prevent"])),class:"password-form"},[e("div",Bs,[s[59]||(s[59]=e("label",{class:"form-label"},"Current Password",-1)),p(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.passwordForm.current_password=o),type:"password",class:"form-control",required:""},null,512),[[g,t.passwordForm.current_password]])]),e("div",Gs,[s[60]||(s[60]=e("label",{class:"form-label"},"New Password",-1)),p(e("input",{"onUpdate:modelValue":s[4]||(s[4]=o=>t.passwordForm.new_password=o),type:"password",class:"form-control",required:""},null,512),[[g,t.passwordForm.new_password]])]),e("div",Ys,[s[61]||(s[61]=e("label",{class:"form-label"},"Confirm New Password",-1)),p(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>t.passwordForm.confirm_password=o),type:"password",class:"form-control",required:""},null,512),[[g,t.passwordForm.confirm_password]])]),e("button",{type:"submit",class:"btn btn-primary",disabled:t.changingPassword},i(t.changingPassword?"Changing...":"Change Password"),9,Ks)],32),s[66]||(s[66]=e("h5",{class:"subsection-title",style:{"margin-top":"2rem"}},"Two-Factor Authentication (2FA)",-1)),e("div",Qs,[t.user.totp_enabled?(n(),l("div",Ws,[s[62]||(s[62]=e("div",{class:"flex gap-2 align-center"},[e("span",{class:"badge badge-success"},"âœ“ Enabled"),e("p",{class:"text-sm"},"2FA is currently enabled for your account")],-1)),e("button",{onClick:s[7]||(s[7]=(...o)=>t.disableTOTP&&t.disableTOTP(...o)),class:"btn btn-danger",disabled:t.totp_loading},i(t.totp_loading?"Disabling...":"Disable 2FA"),9,zs)])):(n(),l("div",js,[s[63]||(s[63]=e("div",{class:"flex gap-2 align-center"},[e("span",{class:"badge badge-warning"},"âš  Disabled"),e("p",{class:"text-sm"},"Enable 2FA for enhanced account security")],-1)),e("button",{onClick:s[8]||(s[8]=(...o)=>t.setupTOTP&&t.setupTOTP(...o)),class:"btn btn-primary",disabled:t.totp_loading},i(t.totp_loading?"Setting up...":"Enable 2FA"),9,Js)]))])])])):c("",!0)])]),e("div",Xs,[s[77]||(s[77]=e("div",{class:"card-header"},[e("h3",null,"Cloud Image Setup")],-1)),e("div",Zs,[s[76]||(s[76]=e("div",{class:"info-box"},[e("h4",null,"ðŸš€ Enable Automatic Cloud Image Deployments"),e("p",null,"Cloud images allow you to deploy VMs with the OS pre-installed in seconds!"),e("p",{class:"text-sm text-muted"}," This one-time setup configures SSH access to your Proxmox server, enabling: "),e("ul",{class:"feature-list"},[e("li",null,"âœ… Automatic OS installation (Ubuntu, Debian, etc.)"),e("li",null,"âœ… Pre-configured credentials"),e("li",null,"âœ… 30-second deployments (after initial template creation)"),e("li",null,"âœ… No manual installation needed")])],-1)),t.sshStatus===null?(n(),l("div",$s,[...s[68]||(s[68]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Checking SSH configuration...",-1)])])):t.sshStatus===!0?(n(),l("div",se,[...s[69]||(s[69]=[e("div",{class:"status-icon"},"âœ…",-1),e("div",null,[e("h4",null,"Cloud Images Enabled!"),e("p",null,"SSH access is configured. You can now deploy VMs from cloud images."),e("p",{class:"text-sm text-muted"},"First deployment per image takes ~5-10 minutes. All subsequent deployments take ~30 seconds.")],-1)])])):(n(),l("div",ee,[s[75]||(s[75]=e("div",{class:"status-icon"},"âš ï¸",-1)),e("div",null,[s[71]||(s[71]=e("h4",null,"Setup Required",-1)),s[72]||(s[72]=e("p",null,[e("strong",null,"Quick Setup:"),f(" Click the button below to enable cloud images automatically!")],-1)),e("div",te,[e("button",{onClick:s[9]||(s[9]=o=>t.showPasswordPrompt=!0),class:"btn btn-success btn-lg"}," ðŸš€ Enable Cloud Images Now "),e("button",{onClick:s[10]||(s[10]=(...o)=>t.checkSSHStatus&&t.checkSSHStatus(...o)),class:"btn btn-outline",disabled:t.checkingSSH},i(t.checkingSSH?"Checking...":"Re-check Status"),9,oe)]),s[73]||(s[73]=e("div",{class:"or-divider"},[e("span",null,"OR")],-1)),s[74]||(s[74]=e("p",{class:"text-sm text-muted"},[e("strong",null,"Manual Setup:"),f(" Run this command on your server:")],-1)),e("div",ae,[s[70]||(s[70]=e("code",null,"sudo /tmp/enable_cloud_images.sh",-1)),e("button",{onClick:s[11]||(s[11]=(...o)=>t.copyCommand&&t.copyCommand(...o)),class:"btn btn-sm btn-outline"},i(t.commandCopied?"âœ“ Copied":"Copy"),1)]),e("div",le,[e("button",{onClick:s[12]||(s[12]=o=>t.showSetupInstructions=!0),class:"btn btn-sm btn-outline"}," ðŸ“– View Full Instructions ")])])]))])]),e("div",ne,[s[82]||(s[82]=e("div",{class:"card-header"},[e("h3",null,"ðŸ”— Proxmox Cluster Inter-Node SSH"),e("p",null,"Required for multi-node clusters to create templates on specific nodes")],-1)),e("div",re,[s[81]||(s[81]=e("div",{class:"info-box"},[e("p",null,[e("strong",null,"Why needed?"),f(" When deploying to different nodes in your cluster, the system needs to create cloud image templates on each specific node. This requires SSH access between cluster nodes.")]),e("p",{class:"text-sm text-muted"},"Single-node setups don't need this.")],-1)),t.clusterSSHStatus===null?(n(),l("div",ie,[...s[78]||(s[78]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Checking inter-node SSH configuration...",-1)])])):t.clusterSSHStatus===!0?(n(),l("div",de,[...s[79]||(s[79]=[e("div",{class:"status-icon"},"âœ…",-1),e("div",null,[e("h4",null,"Inter-Node SSH Enabled!"),e("p",null,"SSH keys are configured between cluster nodes."),e("p",{class:"text-sm text-muted"},"Cloud image templates can be created on any node in your cluster.")],-1)])])):(n(),l("div",ue,[...s[80]||(s[80]=[e("div",{class:"status-icon"},"âš ï¸",-1),e("div",null,[e("h4",null,"Setup Required"),e("p",null,"Inter-node SSH is not configured yet.")],-1)])])),e("div",ce,[t.clusterSSHStatus!==!0?(n(),l("button",{key:0,onClick:s[13]||(s[13]=o=>t.showClusterSSHPrompt=!0),class:"btn btn-primary"}," ðŸ” Enable Inter-Node SSH ")):(n(),l("button",{key:1,onClick:s[14]||(s[14]=(...o)=>t.checkClusterSSHStatus&&t.checkClusterSSHStatus(...o)),class:"btn btn-outline",disabled:t.checkingClusterSSH},i(t.checkingClusterSSH?"Checking...":"ðŸ”„ Re-check Status"),9,ve))])])]),e("div",me,[s[89]||(s[89]=e("div",{class:"card-header"},[e("h3",null,"ðŸ”’ High Availability (HA) & Failover"),e("p",null,"Automatically restart VMs on other nodes if a node fails")],-1)),e("div",fe,[s[88]||(s[88]=e("div",{class:"info-box"},[e("p",null,[e("strong",null,"What is HA?"),f(" High Availability ensures your critical VMs automatically restart on another node if the current node fails or goes offline.")]),e("p",{class:"text-sm text-muted"},[e("strong",null,"Requirements:"),f(" Multi-node Proxmox cluster with shared storage ")]),e("ul",{class:"feature-list text-sm"},[e("li",null,"âœ… Automatic VM migration on node failure"),e("li",null,"âœ… Configurable restart priorities"),e("li",null,"âœ… Minimal downtime for critical services"),e("li",null,"âœ… Health monitoring and alerting")])],-1)),t.haStatus===null?(n(),l("div",pe,[...s[83]||(s[83]=[e("div",{class:"loading-spinner"},null,-1),e("p",null,"Checking HA status...",-1)])])):t.haStatus&&t.haStatus.enabled?(n(),l("div",be,[s[86]||(s[86]=e("div",{class:"status-icon"},"âœ…",-1)),e("div",null,[s[84]||(s[84]=e("h4",null,"HA Enabled",-1)),s[85]||(s[85]=e("p",null,"High Availability is configured and active on your cluster.",-1)),e("p",ge,"Protected VMs: "+i(t.haStatus.protected_vms||0),1)])])):(n(),l("div",ye,[...s[87]||(s[87]=[e("div",{class:"status-icon"},"âš ï¸",-1),e("div",null,[e("h4",null,"HA Not Configured"),e("p",null,"Enable High Availability to protect your VMs from node failures.")],-1)])])),e("div",Se,[e("button",{onClick:s[15]||(s[15]=(...o)=>t.checkHAStatus&&t.checkHAStatus(...o)),class:"btn btn-outline",disabled:t.checkingHA},i(t.checkingHA?"Checking...":"ðŸ” Check HA Status"),9,we),t.haStatus&&!t.haStatus.enabled?(n(),l("button",{key:0,onClick:s[16]||(s[16]=o=>t.showHAPrompt=!0),class:"btn btn-success"}," ðŸ”’ Enable High Availability ")):c("",!0)]),t.haError?(n(),l("div",ke,i(t.haError),1)):c("",!0)])]),e("div",he,[s[96]||(s[96]=e("div",{class:"card-header"},[e("h3",null,"ðŸ”„ System Updates"),e("p",null,"Keep Depl0y up to date from deploy.agit8or.net")],-1)),e("div",xe,[t.checkingUpdates&&!t.updateInfo?(n(),l("div",Ce,[...s[90]||(s[90]=[e("p",{class:"text-muted"},"â³ Checking for updates...",-1)])])):t.updateError&&!t.updateInfo?(n(),l("div",He,[e("p",null,[s[91]||(s[91]=e("strong",null,"Error:",-1)),f(" "+i(t.updateError),1)]),s[92]||(s[92]=e("p",{class:"text-muted"},'Click "Check for Updates" to try again',-1))])):t.updateInfo?(n(),l("div",Pe,[e("p",null,[s[93]||(s[93]=e("strong",null,"Current Version:",-1)),f(" "+i(t.updateInfo.current_version),1)]),e("p",null,[s[94]||(s[94]=e("strong",null,"Latest Version:",-1)),f(" "+i(t.updateInfo.latest_version),1)]),t.updateInfo.update_available?(n(),l("p",Ae," âœ¨ Update available! ")):(n(),l("p",Ie," âœ… You're running the latest version "))])):c("",!0),t.updateInfo&&t.updateInfo.release_notes?(n(),l("div",Te,[s[95]||(s[95]=e("h4",null,"Release Notes:",-1)),e("pre",null,i(t.updateInfo.release_notes),1)])):c("",!0),e("div",Fe,[e("button",{onClick:s[17]||(s[17]=(...o)=>t.checkForUpdates&&t.checkForUpdates(...o)),class:"btn btn-outline",disabled:t.checkingUpdates},i(t.checkingUpdates?"Checking...":"ðŸ” Check for Updates"),9,Ee),t.updateInfo&&t.updateInfo.update_available?(n(),l("button",{key:0,onClick:s[18]||(s[18]=(...o)=>t.applyUpdate&&t.applyUpdate(...o)),class:"btn btn-success",disabled:t.applyingUpdate},i(t.applyingUpdate?"Updating...":"â¬‡ï¸ Install Update"),9,Ue)):c("",!0)]),t.updateError?(n(),l("div",Me,i(t.updateError),1)):c("",!0),t.updateSuccess?(n(),l("div",Ve,i(t.updateSuccess),1)):c("",!0)])]),t.showSetupInstructions?(n(),l("div",{key:0,class:"modal",onClick:s[22]||(s[22]=o=>t.showSetupInstructions=!1)},[e("div",{class:"modal-content modal-large",onClick:s[21]||(s[21]=b(()=>{},["stop"]))},[e("div",Oe,[s[97]||(s[97]=e("h3",null,"Cloud Image Setup Instructions",-1)),e("button",{onClick:s[19]||(s[19]=o=>t.showSetupInstructions=!1),class:"btn-close"},"Ã—")]),s[98]||(s[98]=M('<div class="modal-body setup-instructions" data-v-5f881903><h4 data-v-5f881903>Step 1: Run the Setup Script</h4><p data-v-5f881903>SSH into your Depl0y server and run:</p><div class="command-box" data-v-5f881903><code data-v-5f881903>sudo /tmp/enable_cloud_images.sh</code></div><h4 data-v-5f881903>Step 2: Enter Proxmox Password</h4><p data-v-5f881903>The script will prompt for your Proxmox root password to configure SSH access.</p><h4 data-v-5f881903>Step 3: Verify</h4><p data-v-5f881903>Click &quot;Re-check Status&quot; above to verify the setup completed successfully.</p><h4 data-v-5f881903>Step 4: Deploy VMs!</h4><p data-v-5f881903>Go to Create VM â†’ Select &quot;Cloud Image (Fast)&quot; â†’ Choose any cloud image.</p><div class="info-box" data-v-5f881903><h5 data-v-5f881903>What Happens Next?</h5><ul data-v-5f881903><li data-v-5f881903><strong data-v-5f881903>First time per cloud image:</strong> System downloads and creates a template (~5-10 min)</li><li data-v-5f881903><strong data-v-5f881903>All subsequent VMs:</strong> Instant cloning from template (~30 seconds)</li><li data-v-5f881903><strong data-v-5f881903>Result:</strong> VM boots with OS fully installed and your credentials configured!</li></ul></div><div class="warning-box" data-v-5f881903><h5 data-v-5f881903>Security Note</h5><p data-v-5f881903>This setup uses SSH key authentication (no passwords stored). The Depl0y server&#39;s public key is added to your Proxmox server&#39;s authorized_keys file.</p></div></div>',1)),e("div",Re,[e("button",{onClick:s[20]||(s[20]=o=>t.showSetupInstructions=!1),class:"btn btn-primary"}," Got It! ")])])])):c("",!0),t.showPasswordPrompt?(n(),l("div",{key:1,class:"modal",onClick:s[29]||(s[29]=o=>t.showPasswordPrompt=!1)},[e("div",{class:"modal-content",onClick:s[28]||(s[28]=b(()=>{},["stop"]))},[e("div",_e,[s[99]||(s[99]=e("h3",null,"ðŸš€ Enable Cloud Images",-1)),e("button",{onClick:s[23]||(s[23]=o=>t.showPasswordPrompt=!1),class:"btn-close"},"Ã—")]),e("div",Le,[s[102]||(s[102]=e("p",null,"To enable cloud images, we need to configure SSH access to your Proxmox server.",-1)),s[103]||(s[103]=e("p",{class:"text-sm text-muted"},"This is a one-time setup that takes about 30 seconds.",-1)),e("div",qe,[s[100]||(s[100]=e("label",{for:"proxmox-password"},"Proxmox Root Password",-1)),p(e("input",{type:"password",id:"proxmox-password","onUpdate:modelValue":s[24]||(s[24]=o=>t.proxmoxPassword=o),class:"form-control",placeholder:"Enter Proxmox root password",disabled:t.enablingCloudImages,onKeyup:s[25]||(s[25]=es((...o)=>t.enableCloudImages&&t.enableCloudImages(...o),["enter"]))},null,40,De),[[g,t.proxmoxPassword]]),s[101]||(s[101]=e("p",{class:"text-sm text-muted mt-2"}," ðŸ”’ Your password is only used once to copy the SSH key and is not stored anywhere. ",-1))]),t.setupError?(n(),l("div",Ne,i(t.setupError),1)):c("",!0),t.setupSuccess?(n(),l("div",Be," âœ… "+i(t.setupSuccess),1)):c("",!0)]),e("div",Ge,[e("button",{onClick:s[26]||(s[26]=o=>t.showPasswordPrompt=!1),class:"btn btn-outline",disabled:t.enablingCloudImages}," Cancel ",8,Ye),e("button",{onClick:s[27]||(s[27]=(...o)=>t.enableCloudImages&&t.enableCloudImages(...o)),class:"btn btn-success",disabled:!t.proxmoxPassword||t.enablingCloudImages},i(t.enablingCloudImages?"Setting up...":"Enable Cloud Images"),9,Ke)])])])):c("",!0),t.showTOTPModal?(n(),l("div",{key:2,class:"modal",onClick:s[34]||(s[34]=o=>t.showTOTPModal=!1)},[e("div",{class:"modal-content",onClick:s[33]||(s[33]=b(()=>{},["stop"]))},[e("div",Qe,[s[104]||(s[104]=e("h3",null,"Setup Two-Factor Authentication",-1)),e("button",{onClick:s[30]||(s[30]=o=>t.showTOTPModal=!1),class:"btn-close"},"Ã—")]),e("div",We,[t.totpSetup?(n(),l("div",ze,[s[107]||(s[107]=e("p",null,"Scan this QR code with your authenticator app (Google Authenticator, Authy, etc.)",-1)),e("div",je,[e("img",{src:t.totpSetup.qr_code,alt:"QR Code"},null,8,Je)]),s[108]||(s[108]=e("p",{class:"text-sm text-muted"},"Or enter this code manually:",-1)),e("code",Xe,i(t.totpSetup.secret),1),e("form",{onSubmit:s[32]||(s[32]=b((...o)=>t.verifyTOTP&&t.verifyTOTP(...o),["prevent"])),class:"totp-verify-form"},[e("div",Ze,[s[105]||(s[105]=e("label",{class:"form-label"},"Enter 6-digit code from your app:",-1)),p(e("input",{"onUpdate:modelValue":s[31]||(s[31]=o=>t.totpCode=o),type:"text",class:"form-control",maxlength:"6",pattern:"[0-9]{6}",required:""},null,512),[[g,t.totpCode]])]),s[106]||(s[106]=e("button",{type:"submit",class:"btn btn-primary"}," Verify & Enable ",-1))],32)])):c("",!0)])])])):c("",!0),e("div",$e,[s[113]||(s[113]=e("div",{class:"card-header"},[e("h3",null,"About Depl0y")],-1)),e("div",st,[s[111]||(s[111]=e("div",{class:"logo-section"},[e("h1",{class:"about-logo"},[f("Depl"),e("span",{class:"logo-zero"},"0"),f("y")]),e("p",{class:"tagline"},"VM Deployment Panel for Proxmox VE")],-1)),e("div",et,[e("div",tt,[s[109]||(s[109]=e("span",{class:"info-label"},"Version",-1)),e("span",ot,i(((w=t.updateInfo)==null?void 0:w.current_version)||"Loading..."),1)]),s[110]||(s[110]=M('<div class="info-item" data-v-5f881903><span class="info-label" data-v-5f881903>Status</span><span class="badge badge-success" data-v-5f881903>Running</span></div><div class="info-item" data-v-5f881903><span class="info-label" data-v-5f881903>Backend</span><span class="info-value" data-v-5f881903>FastAPI (Python)</span></div><div class="info-item" data-v-5f881903><span class="info-label" data-v-5f881903>Frontend</span><span class="info-value" data-v-5f881903>Vue.js 3</span></div><div class="info-item" data-v-5f881903><span class="info-label" data-v-5f881903>Database</span><span class="info-value" data-v-5f881903>SQLite</span></div><div class="info-item" data-v-5f881903><span class="info-label" data-v-5f881903>License</span><span class="info-value" data-v-5f881903>Open Source</span></div>',5))]),s[112]||(s[112]=M('<div class="builder-section" data-v-5f881903><div class="builder-card" data-v-5f881903><div class="builder-icon" data-v-5f881903>ðŸš€</div><div class="builder-info" data-v-5f881903><h4 data-v-5f881903>Built by</h4><a href="https://www.agit8or.net" target="_blank" rel="noopener noreferrer" class="builder-link" data-v-5f881903><strong data-v-5f881903>Agit8or</strong></a><p class="builder-url" data-v-5f881903>www.agit8or.net</p></div></div></div><div class="features-section" data-v-5f881903><h4 class="section-title" data-v-5f881903>Features</h4><div class="features-grid" data-v-5f881903><div class="feature-item" data-v-5f881903><span class="feature-icon" data-v-5f881903>âœ“</span><span data-v-5f881903>Automated VM Deployment</span></div><div class="feature-item" data-v-5f881903><span class="feature-icon" data-v-5f881903>âœ“</span><span data-v-5f881903>Cloud-init Support</span></div><div class="feature-item" data-v-5f881903><span class="feature-icon" data-v-5f881903>âœ“</span><span data-v-5f881903>ISO Management</span></div><div class="feature-item" data-v-5f881903><span class="feature-icon" data-v-5f881903>âœ“</span><span data-v-5f881903>Multi-user Authentication</span></div><div class="feature-item" data-v-5f881903><span class="feature-icon" data-v-5f881903>âœ“</span><span data-v-5f881903>2FA Support (TOTP)</span></div><div class="feature-item" data-v-5f881903><span class="feature-icon" data-v-5f881903>âœ“</span><span data-v-5f881903>Update Management</span></div><div class="feature-item" data-v-5f881903><span class="feature-icon" data-v-5f881903>âœ“</span><span data-v-5f881903>Resource Monitoring</span></div><div class="feature-item" data-v-5f881903><span class="feature-icon" data-v-5f881903>âœ“</span><span data-v-5f881903>Proxmox API Integration</span></div></div></div>',2))])]),t.systemInfo?(n(),l("div",at,[s[117]||(s[117]=e("div",{class:"card-header"},[e("h3",null,"System Information")],-1)),e("div",lt,[e("div",nt,[s[114]||(s[114]=e("span",{class:"info-label"},"Total VMs",-1)),e("span",rt,i(t.systemInfo.total_vms),1)]),e("div",it,[s[115]||(s[115]=e("span",{class:"info-label"},"Active Proxmox Hosts",-1)),e("span",dt,i(t.systemInfo.datacenters),1)]),e("div",ut,[s[116]||(s[116]=e("span",{class:"info-label"},"ISO Images",-1)),e("span",ct,i(t.systemInfo.total_isos),1)])])])):c("",!0),t.user&&t.user.role==="admin"?(n(),l("div",vt,[e("div",mt,[s[118]||(s[118]=e("h3",null,"Backend Logs",-1)),e("button",{onClick:s[35]||(s[35]=(...o)=>t.refreshLogs&&t.refreshLogs(...o)),class:"btn btn-primary",disabled:t.loadingLogs},i(t.loadingLogs?"Loading...":"Refresh"),9,ft)]),e("div",pt,[e("div",bt,[e("label",gt,[s[120]||(s[120]=f(" Show last ",-1)),p(e("select",{"onUpdate:modelValue":s[36]||(s[36]=o=>t.logLines=o),onChange:s[37]||(s[37]=(...o)=>t.refreshLogs&&t.refreshLogs(...o)),class:"log-lines-select"},[...s[119]||(s[119]=[e("option",{value:50},"50",-1),e("option",{value:100},"100",-1),e("option",{value:200},"200",-1),e("option",{value:500},"500",-1)])],544),[[As,t.logLines]]),s[121]||(s[121]=f(" lines ",-1))])]),t.backendLogs?(n(),l("div",yt,[e("pre",St,i(t.backendLogs),1)])):(n(),l("div",wt,[...s[122]||(s[122]=[e("p",null,'Click "Refresh" to load logs',-1)])]))])])):c("",!0),t.showClusterSSHPrompt?(n(),l("div",{key:5,class:"modal",onClick:s[44]||(s[44]=o=>t.showClusterSSHPrompt=!1)},[e("div",{class:"modal-content",onClick:s[43]||(s[43]=b(()=>{},["stop"]))},[e("div",kt,[s[123]||(s[123]=e("h3",null,"ðŸ” Enable Inter-Node SSH",-1)),e("button",{onClick:s[38]||(s[38]=o=>t.showClusterSSHPrompt=!1),class:"btn-close"},"Ã—")]),e("div",ht,[s[126]||(s[126]=e("p",null,"To enable inter-node SSH, we need to configure SSH keys between your Proxmox cluster nodes.",-1)),s[127]||(s[127]=e("p",{class:"text-sm text-muted"},"This is a one-time setup that takes about 30 seconds.",-1)),e("div",xt,[s[124]||(s[124]=e("label",{for:"cluster-password"},"Proxmox Root Password",-1)),p(e("input",{type:"password",id:"cluster-password","onUpdate:modelValue":s[39]||(s[39]=o=>t.clusterPassword=o),class:"form-control",placeholder:"Enter Proxmox root password",disabled:t.enablingClusterSSH,onKeyup:s[40]||(s[40]=es((...o)=>t.enableClusterSSH&&t.enableClusterSSH(...o),["enter"]))},null,40,Ct),[[g,t.clusterPassword]]),s[125]||(s[125]=e("p",{class:"text-sm text-muted mt-2"}," ðŸ”’ Your password is only used once to set up SSH keys and is not stored anywhere. ",-1))]),t.clusterSSHError?(n(),l("div",Ht,i(t.clusterSSHError),1)):c("",!0),t.clusterSSHSuccess?(n(),l("div",Pt," âœ… "+i(t.clusterSSHSuccess),1)):c("",!0)]),e("div",At,[e("button",{onClick:s[41]||(s[41]=o=>t.showClusterSSHPrompt=!1),class:"btn btn-outline",disabled:t.enablingClusterSSH}," Cancel ",8,It),e("button",{onClick:s[42]||(s[42]=(...o)=>t.enableClusterSSH&&t.enableClusterSSH(...o)),class:"btn btn-primary",disabled:!t.clusterPassword||t.enablingClusterSSH},i(t.enablingClusterSSH?"Setting up...":"Enable Inter-Node SSH"),9,Tt)])])])):c("",!0),t.showHAPrompt?(n(),l("div",{key:6,class:"modal",onClick:s[51]||(s[51]=o=>t.showHAPrompt=!1)},[e("div",{class:"modal-content",onClick:s[50]||(s[50]=b(()=>{},["stop"]))},[e("div",Ft,[s[128]||(s[128]=e("h3",null,"ðŸ”’ Enable High Availability",-1)),e("button",{onClick:s[45]||(s[45]=o=>t.showHAPrompt=!1),class:"btn-close"},"Ã—")]),e("div",Et,[s[131]||(s[131]=e("p",null,"High Availability will be enabled on your Proxmox cluster, allowing automatic failover of VMs.",-1)),s[132]||(s[132]=e("p",{class:"text-sm text-muted"},"This requires:",-1)),s[133]||(s[133]=e("ul",{class:"text-sm"},[e("li",null,"Multi-node Proxmox cluster"),e("li",null,"Shared storage accessible by all nodes"),e("li",null,"Proxmox root access")],-1)),e("div",Ut,[s[129]||(s[129]=e("label",{for:"ha-password"},"Proxmox Root Password",-1)),p(e("input",{type:"password",id:"ha-password","onUpdate:modelValue":s[46]||(s[46]=o=>t.haPassword=o),class:"form-control",placeholder:"Enter Proxmox root password",disabled:t.enablingHA,onKeyup:s[47]||(s[47]=es((...o)=>t.enableHA&&t.enableHA(...o),["enter"]))},null,40,Mt),[[g,t.haPassword]]),s[130]||(s[130]=e("p",{class:"text-sm text-muted mt-2"}," ðŸ”’ Your password is only used once to configure HA and is not stored. ",-1))]),t.haSetupError?(n(),l("div",Vt,i(t.haSetupError),1)):c("",!0),t.haSetupSuccess?(n(),l("div",Ot," âœ… "+i(t.haSetupSuccess),1)):c("",!0)]),e("div",Rt,[e("button",{onClick:s[48]||(s[48]=o=>t.showHAPrompt=!1),class:"btn btn-outline",disabled:t.enablingHA}," Cancel ",8,_t),e("button",{onClick:s[49]||(s[49]=(...o)=>t.enableHA&&t.enableHA(...o)),class:"btn btn-success",disabled:!t.haPassword||t.enablingHA},i(t.enablingHA?"Enabling HA...":"ðŸ”’ Enable High Availability"),9,Lt)])])])):c("",!0),t.showHAManagement?(n(),l("div",{key:7,class:"modal",onClick:s[55]||(s[55]=o=>t.showHAManagement=!1)},[e("div",{class:"modal-content modal-large",onClick:s[54]||(s[54]=b(()=>{},["stop"]))},[e("div",qt,[s[134]||(s[134]=e("h3",null,"âš™ï¸ Manage HA Groups",-1)),e("button",{onClick:s[52]||(s[52]=o=>t.showHAManagement=!1),class:"btn-close"},"Ã—")]),s[135]||(s[135]=M('<div class="modal-body" data-v-5f881903><p data-v-5f881903>Configure which VMs are protected by High Availability and their restart priorities.</p><div class="info-box" style="margin-bottom:1rem;" data-v-5f881903><p class="text-sm" data-v-5f881903><strong data-v-5f881903>Priority Levels:</strong></p><ul class="text-sm" data-v-5f881903><li data-v-5f881903><strong data-v-5f881903>1-10:</strong> Critical services (restarted first)</li><li data-v-5f881903><strong data-v-5f881903>11-50:</strong> Important services</li><li data-v-5f881903><strong data-v-5f881903>51-100:</strong> Standard services</li></ul></div><p class="text-center text-muted" data-v-5f881903>HA Group management coming soon! For now, use the Proxmox web interface to manage HA groups.</p><p class="text-sm text-center text-muted" data-v-5f881903>Datacenter â†’ HA â†’ Groups/Resources</p></div>',1)),e("div",Dt,[e("button",{onClick:s[53]||(s[53]=o=>t.showHAManagement=!1),class:"btn btn-primary"}," Close ")])])])):c("",!0)])}const Gt=Hs(Fs,[["render",Nt],["__scopeId","data-v-5f881903"]]);export{Gt as default};
