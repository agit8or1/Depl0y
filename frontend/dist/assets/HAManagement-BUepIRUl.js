import{_ as Q,r as d,y as $,j as O,z as ee,o as l,c as a,d as u,a as e,F as G,p as N,m as H,t as n,e as f,b as v,C as B,A as j,v as W,E as I,w as se,T as te,l as y,g as oe,h as le,B as ae,k as ne}from"./index-DpP9cWht.js";const re={name:"HAWizard",props:{isOpen:{type:Boolean,required:!0}},emits:["close","complete"],setup(q,{emit:s}){const V=["Prerequisites","HA Group","Select VMs","Policies","Review"],t=d(0),M=d(!1),b=d(null),o=d("existing"),r=d([]),R=d(null),F=d(null),S=d(!0),z=d([]),_=d([]),U=d(!1),k=d({name:"",restricted:!1,nofailback:!1,comment:""}),g=d(!1),h=d([]),c=d([]),D=d({state:"started",max_restart:1,max_relocate:1}),T=d(!1),P=d(null);$(()=>q.isOpen,async i=>{i&&t.value===0&&(await Y(),await K(),await J())});const Y=async()=>{var i,A;M.value=!0;try{const p=(await y.ha.checkStatus()).data;b.value={quorum:p.quorum||!1,nodes:1,manager_active:p.manager_status==="active",error:p.error||null};try{const w=await y.proxmox.listHosts();if(w.data&&w.data.length>0){const m=w.data[0].id,C=await y.proxmox.listNodes(m);b.value.nodes=C.data.length}}catch(w){console.error("Failed to get node count:",w)}}catch(x){console.error("Prerequisites check failed:",x),b.value={quorum:!1,nodes:0,manager_active:!1,error:((A=(i=x.response)==null?void 0:i.data)==null?void 0:A.detail)||"Failed to check prerequisites"}}finally{M.value=!1}},K=async()=>{try{const i=await y.ha.listGroups();r.value=i.data.groups||[],i.data.message&&i.data.message.includes("migrated to rules")?(F.value=i.data.message,S.value=!1,r.value.length===0?o.value="skip":o.value="existing"):r.value.length>0?o.value="existing":o.value="new"}catch(i){console.error("Failed to load HA groups:",i)}},J=async()=>{U.value=!0;try{const i=await y.proxmox.listHosts();if(i.data&&i.data.length>0){const A=i.data[0].id,x=await y.proxmox.listNodes(A);z.value=x.data||[]}}catch(i){console.error("Failed to load nodes:",i)}finally{U.value=!1}},X=async()=>{g.value=!0;try{const i=await y.vms.list(),A=await y.ha.listResources(),x=new Set((A.data.resources||[]).map(p=>{var m;const w=(m=p.sid)==null?void 0:m.match(/vm:(\d+)/);return w?parseInt(w[1]):null}).filter(Boolean));h.value=(i.data||[]).filter(p=>p.vmid&&!x.has(p.vmid)).map(p=>({vmid:p.vmid,name:p.name,node:p.node_name||"unknown",status:p.status||"unknown"}))}catch(i){console.error("Failed to load VMs:",i)}finally{g.value=!1}},L=O(()=>{var i;switch(t.value){case 0:return((i=b.value)==null?void 0:i.quorum)===!0;case 1:return o.value==="new"&&S.value?k.value.name&&_.value.length>0:o.value==="existing"?R.value!==null:o.value==="skip";case 2:return c.value.length>0;case 3:return!0;default:return!1}}),Z=O(()=>c.value.length===0?!1:o.value==="skip"?!0:o.value==="existing"?R.value!==null:o.value==="new"?k.value.name&&_.value.length>0:!1);return{steps:V,currentStep:t,checkingPrerequisites:M,prerequisiteResults:b,groupMode:o,existingGroups:r,selectedGroup:R,groupsMessage:F,canCreateGroups:S,availableNodes:z,selectedNodes:_,loadingNodes:U,newGroup:k,loadingVMs:g,availableVMs:h,selectedVMs:c,haConfig:D,applying:T,applyResult:P,canProceed:L,canApply:Z,nextStep:async()=>{t.value<V.length-1&&L.value&&(t.value++,t.value===2&&await X())},previousStep:()=>{t.value>0&&(t.value--,P.value=null)},applyConfiguration:async()=>{var A,x,p,w;T.value=!0,P.value=null;const i=[];try{let m=null;if(o.value==="skip")m=null,i.push("Skipping group configuration (Proxmox 8.x)");else if(o.value==="existing")m=R.value;else if(o.value==="new"&&S.value)try{await y.ha.createGroup({group:k.value.name,nodes:_.value.join(","),restricted:k.value.restricted?1:0,nofailback:k.value.nofailback?1:0,comment:k.value.comment||null}),m=k.value.name,i.push(`Created HA group: ${k.value.name}`)}catch(C){throw new Error(`Failed to create HA group: ${((x=(A=C.response)==null?void 0:A.data)==null?void 0:x.detail)||C.message}`)}for(const C of c.value)try{const E={sid:`vm:${C}`,state:D.value.state,max_restart:D.value.max_restart,max_relocate:D.value.max_relocate};m&&(E.group=m),await y.ha.addResource(E),i.push(`Added VM ${C} to HA protection${m?` (group: ${m})`:""}`)}catch(E){i.push(`Failed to add VM ${C}: ${((w=(p=E.response)==null?void 0:p.data)==null?void 0:w.detail)||E.message}`)}P.value={success:!0,details:i},s("complete")}catch(m){P.value={success:!1,error:m.message||"Failed to apply configuration"}}finally{T.value=!1}},close:()=>{s("close"),setTimeout(()=>{t.value=0,b.value=null,c.value=[],P.value=null},300)}}}},ie={class:"wizard-modal"},de={class:"wizard-header"},ue={class:"wizard-steps"},ce={class:"step-number"},ve={class:"step-label"},pe={class:"wizard-body"},ge={key:0,class:"wizard-step"},me={key:0,class:"loading"},fe={key:1,class:"prerequisite-results"},ye={class:"icon"},be={class:"icon"},he={class:"icon"},ke={key:0,class:"error-message"},we={key:1,class:"wizard-step"},xe={key:0,class:"info-message"},Me={class:"form-group"},Ae=["disabled"],He={key:1,class:"group-selection"},Ve=["value"],Re={class:"form-group"},Se=["disabled"],_e={key:2,class:"form-group"},Ce={key:3,class:"new-group-form"},Ge={class:"form-group"},Ne={class:"form-group"},qe={key:0,class:"loading-inline"},ze={key:1,class:"empty-state-inline"},Pe={key:2,class:"node-selection"},Ue=["value"],Ee={class:"node-info"},Fe={class:"help-text"},De={class:"form-group"},We={class:"form-group"},Ie={class:"form-group"},Te={key:2,class:"wizard-step"},Be={key:0,class:"loading"},Le={key:1,class:"empty-state"},Oe={key:2,class:"vm-list"},je={class:"vm-checkbox"},Qe=["value"],Ye={class:"vm-info"},Ke={class:"vm-details"},Je={key:3,class:"selection-summary"},Xe={key:3,class:"wizard-step"},Ze={class:"form-group"},$e={class:"form-group"},es={class:"form-group"},ss={key:4,class:"wizard-step"},ts={class:"review-section"},os={class:"review-item"},ls={key:0,class:"review-item"},as={key:1,class:"review-item"},ns={key:2,class:"review-item"},rs={key:3,class:"review-item"},is={class:"review-section"},ds={class:"review-item"},us={key:0,class:"review-item"},cs={class:"review-section"},vs={class:"review-item"},ps={class:"review-item"},gs={class:"review-item"},ms={key:0,class:"loading"},fs={key:1,class:"apply-result"},ys={key:0,class:"success-message"},bs={key:0},hs={key:1,class:"error-message"},ks={class:"wizard-footer"},ws=["disabled"],xs=["disabled"];function Ms(q,s,V,t,M,b){return l(),ee(te,{to:"body"},[V.isOpen?(l(),a("div",{key:0,class:"wizard-overlay",onClick:s[18]||(s[18]=se((...o)=>t.close&&t.close(...o),["self"]))},[e("div",ie,[e("div",de,[s[19]||(s[19]=e("h2",null,"High Availability Setup Wizard",-1)),e("button",{onClick:s[0]||(s[0]=(...o)=>t.close&&t.close(...o)),class:"close-btn"},"Ã—")]),e("div",ue,[(l(!0),a(G,null,N(t.steps,(o,r)=>(l(),a("div",{key:r,class:H(["step",{active:t.currentStep===r,completed:t.currentStep>r}])},[e("div",ce,n(r+1),1),e("div",ve,n(o),1)],2))),128))]),e("div",pe,[t.currentStep===0?(l(),a("div",ge,[s[24]||(s[24]=e("h3",null,"Checking Prerequisites",-1)),s[25]||(s[25]=e("p",{class:"step-description"},"Verifying your cluster is ready for High Availability",-1)),t.checkingPrerequisites?(l(),a("div",me,[...s[20]||(s[20]=[e("div",{class:"spinner"},null,-1),e("p",null,"Checking cluster status...",-1)])])):t.prerequisiteResults?(l(),a("div",fe,[e("div",{class:H(["check-item",t.prerequisiteResults.quorum?"success":"error"])},[e("span",ye,n(t.prerequisiteResults.quorum?"âœ“":"âœ•"),1),e("div",null,[s[21]||(s[21]=e("strong",null,"Cluster Quorum",-1)),e("p",null,n(t.prerequisiteResults.quorum?"Cluster has quorum - ready for HA":"No quorum - HA requires a multi-node cluster"),1)])],2),e("div",{class:H(["check-item",t.prerequisiteResults.nodes>=2?"success":"warning"])},[e("span",be,n(t.prerequisiteResults.nodes>=2?"âœ“":"âš "),1),e("div",null,[s[22]||(s[22]=e("strong",null,"Cluster Nodes",-1)),e("p",null,n(t.prerequisiteResults.nodes)+" node(s) detected. "+n(t.prerequisiteResults.nodes>=2?"Multi-node cluster ready":"Single node detected - limited HA functionality"),1)])],2),e("div",{class:H(["check-item",t.prerequisiteResults.manager_active?"success":"warning"])},[e("span",he,n(t.prerequisiteResults.manager_active?"âœ“":"âš "),1),e("div",null,[s[23]||(s[23]=e("strong",null,"HA Manager",-1)),e("p",null,n(t.prerequisiteResults.manager_active?"HA Manager is active":"HA Manager status unclear"),1)])],2),t.prerequisiteResults.error?(l(),a("div",ke,n(t.prerequisiteResults.error),1)):u("",!0)])):u("",!0)])):u("",!0),t.currentStep===1?(l(),a("div",we,[s[36]||(s[36]=e("h3",null,"Configure HA Group",-1)),s[37]||(s[37]=e("p",{class:"step-description"},"HA groups define which nodes VMs can run on",-1)),t.groupsMessage?(l(),a("div",xe,[s[26]||(s[26]=e("span",{class:"icon"},"â„¹ï¸",-1)),e("p",null,n(t.groupsMessage),1)])):u("",!0),e("div",Me,[e("label",null,[f(e("input",{type:"radio","onUpdate:modelValue":s[1]||(s[1]=o=>t.groupMode=o),value:"existing",disabled:t.existingGroups.length===0},null,8,Ae),[[B,t.groupMode]]),v(" Use existing HA group "+n(t.existingGroups.length===0?"(none available)":""),1)])]),t.groupMode==="existing"&&t.existingGroups.length>0?(l(),a("div",He,[f(e("select",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.selectedGroup=o),class:"form-control"},[s[27]||(s[27]=e("option",{value:null},"Select a group...",-1)),(l(!0),a(G,null,N(t.existingGroups,o=>(l(),a("option",{key:o.group,value:o.group},n(o.group)+" ("+n(o.nodes)+") ",9,Ve))),128))],512),[[j,t.selectedGroup]])])):u("",!0),e("div",Re,[e("label",null,[f(e("input",{type:"radio","onUpdate:modelValue":s[3]||(s[3]=o=>t.groupMode=o),value:"new",disabled:!t.canCreateGroups},null,8,Se),[[B,t.groupMode]]),v(" Create new HA group "+n(t.canCreateGroups?"":"(not supported on Proxmox 8+)"),1)])]),!t.canCreateGroups&&t.existingGroups.length===0?(l(),a("div",_e,[e("label",null,[f(e("input",{type:"radio","onUpdate:modelValue":s[4]||(s[4]=o=>t.groupMode=o),value:"skip"},null,512),[[B,t.groupMode]]),s[28]||(s[28]=v(" Skip group configuration (Proxmox 8.x - groups managed via web interface) ",-1))])])):u("",!0),t.groupMode==="new"?(l(),a("div",Ce,[e("div",Ge,[s[29]||(s[29]=e("label",{class:"form-label"},"Group Name *",-1)),f(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>t.newGroup.name=o),type:"text",class:"form-control",placeholder:"e.g., production-group"},null,512),[[W,t.newGroup.name]]),s[30]||(s[30]=e("small",{class:"help-text"},"Unique identifier for this HA group",-1))]),e("div",Ne,[s[32]||(s[32]=e("label",{class:"form-label"},"Select Nodes *",-1)),t.loadingNodes?(l(),a("div",qe,[...s[31]||(s[31]=[e("div",{class:"spinner-small"},null,-1),e("span",null,"Loading nodes...",-1)])])):t.availableNodes.length===0?(l(),a("div",ze," No nodes available ")):(l(),a("div",Pe,[(l(!0),a(G,null,N(t.availableNodes,o=>(l(),a("label",{key:o.id,class:"node-checkbox"},[f(e("input",{type:"checkbox",value:o.node_name,"onUpdate:modelValue":s[6]||(s[6]=r=>t.selectedNodes=r)},null,8,Ue),[[I,t.selectedNodes]]),e("div",Ee,[e("strong",null,n(o.node_name),1),e("span",{class:H(["node-status",o.status])},n(o.status),3)])]))),128))])),e("small",Fe,"Select which nodes VMs can run on ("+n(t.selectedNodes.length)+" selected)",1)]),e("div",De,[e("label",null,[f(e("input",{type:"checkbox","onUpdate:modelValue":s[7]||(s[7]=o=>t.newGroup.restricted=o)},null,512),[[I,t.newGroup.restricted]]),s[33]||(s[33]=v(" Restricted (VMs can only run on these nodes) ",-1))])]),e("div",We,[e("label",null,[f(e("input",{type:"checkbox","onUpdate:modelValue":s[8]||(s[8]=o=>t.newGroup.nofailback=o)},null,512),[[I,t.newGroup.nofailback]]),s[34]||(s[34]=v(" No failback (VMs stay on recovery node) ",-1))])]),e("div",Ie,[s[35]||(s[35]=e("label",{class:"form-label"},"Comment (optional)",-1)),f(e("input",{"onUpdate:modelValue":s[9]||(s[9]=o=>t.newGroup.comment=o),type:"text",class:"form-control",placeholder:"Description of this group"},null,512),[[W,t.newGroup.comment]])])])):u("",!0)])):u("",!0),t.currentStep===2?(l(),a("div",Te,[s[41]||(s[41]=e("h3",null,"Select Virtual Machines",-1)),s[42]||(s[42]=e("p",{class:"step-description"},"Choose which VMs to protect with High Availability",-1)),t.loadingVMs?(l(),a("div",Be,[...s[38]||(s[38]=[e("div",{class:"spinner"},null,-1),e("p",null,"Loading virtual machines...",-1)])])):t.availableVMs.length===0?(l(),a("div",Le,[...s[39]||(s[39]=[e("p",null,"No VMs available to add to HA protection",-1)])])):(l(),a("div",Oe,[(l(!0),a(G,null,N(t.availableVMs,o=>(l(),a("div",{key:o.vmid,class:"vm-item"},[e("label",je,[f(e("input",{type:"checkbox",value:o.vmid,"onUpdate:modelValue":s[10]||(s[10]=r=>t.selectedVMs=r)},null,8,Qe),[[I,t.selectedVMs]]),e("div",Ye,[e("strong",null,n(o.name||`VM ${o.vmid}`),1),e("span",Ke,"VMID: "+n(o.vmid)+" | Node: "+n(o.node),1),e("span",{class:H(["vm-status",o.status])},n(o.status),3)])])]))),128))])),t.selectedVMs.length>0?(l(),a("div",Je,[e("strong",null,n(t.selectedVMs.length),1),s[40]||(s[40]=v(" VM(s) selected for HA protection ",-1))])):u("",!0)])):u("",!0),t.currentStep===3?(l(),a("div",Xe,[s[50]||(s[50]=e("h3",null,"Configure HA Policies",-1)),s[51]||(s[51]=e("p",{class:"step-description"},"Set restart and relocation policies for protected VMs",-1)),e("div",Ze,[s[44]||(s[44]=e("label",{class:"form-label"},"Default State",-1)),f(e("select",{"onUpdate:modelValue":s[11]||(s[11]=o=>t.haConfig.state=o),class:"form-control"},[...s[43]||(s[43]=[e("option",{value:"started"},"Started (auto-start after failure)",-1),e("option",{value:"stopped"},"Stopped (don't auto-start)",-1),e("option",{value:"ignored"},"Ignored (no HA management)",-1),e("option",{value:"disabled"},"Disabled (temporarily disable HA)",-1)])],512),[[j,t.haConfig.state]]),s[45]||(s[45]=e("small",{class:"help-text"},"How should VMs behave after a node failure",-1))]),e("div",$e,[s[46]||(s[46]=e("label",{class:"form-label"},"Max Restart Attempts",-1)),f(e("input",{"onUpdate:modelValue":s[12]||(s[12]=o=>t.haConfig.max_restart=o),type:"number",min:"0",max:"10",class:"form-control"},null,512),[[W,t.haConfig.max_restart,void 0,{number:!0}]]),s[47]||(s[47]=e("small",{class:"help-text"},"Maximum times to attempt restarting a failed VM (default: 1)",-1))]),e("div",es,[s[48]||(s[48]=e("label",{class:"form-label"},"Max Relocate Attempts",-1)),f(e("input",{"onUpdate:modelValue":s[13]||(s[13]=o=>t.haConfig.max_relocate=o),type:"number",min:"0",max:"10",class:"form-control"},null,512),[[W,t.haConfig.max_relocate,void 0,{number:!0}]]),s[49]||(s[49]=e("small",{class:"help-text"},"Maximum times to attempt relocating a VM to another node (default: 1)",-1))])])):u("",!0),t.currentStep===4?(l(),a("div",ss,[s[69]||(s[69]=e("h3",null,"Review Configuration",-1)),s[70]||(s[70]=e("p",{class:"step-description"},"Review your High Availability configuration before applying",-1)),e("div",ts,[s[57]||(s[57]=e("h4",null,"HA Group",-1)),e("div",os,[s[52]||(s[52]=e("strong",null,"Mode:",-1)),v(" "+n(t.groupMode==="new"?"Create New Group":t.groupMode==="existing"?"Use Existing Group":"Skip (Proxmox 8.x)"),1)]),t.groupMode==="new"?(l(),a("div",ls,[s[53]||(s[53]=e("strong",null,"Name:",-1)),v(" "+n(t.newGroup.name),1)])):u("",!0),t.groupMode==="new"?(l(),a("div",as,[s[54]||(s[54]=e("strong",null,"Nodes:",-1)),v(" "+n(t.selectedNodes.join(", ")),1)])):u("",!0),t.groupMode==="existing"?(l(),a("div",ns,[s[55]||(s[55]=e("strong",null,"Group:",-1)),v(" "+n(t.selectedGroup||"None selected"),1)])):u("",!0),t.groupMode==="skip"?(l(),a("div",rs,[...s[56]||(s[56]=[e("strong",null,"Note:",-1),v(" VMs will be added to HA without a group (Proxmox 8.x) ",-1)])])):u("",!0)]),e("div",is,[s[60]||(s[60]=e("h4",null,"Protected VMs",-1)),e("div",ds,[s[58]||(s[58]=e("strong",null,"Count:",-1)),v(" "+n(t.selectedVMs.length)+" VM(s) ",1)]),t.selectedVMs.length>0?(l(),a("div",us,[s[59]||(s[59]=e("strong",null,"VM IDs:",-1)),v(" "+n(t.selectedVMs.join(", ")),1)])):u("",!0)]),e("div",cs,[s[64]||(s[64]=e("h4",null,"HA Policies",-1)),e("div",vs,[s[61]||(s[61]=e("strong",null,"State:",-1)),v(" "+n(t.haConfig.state),1)]),e("div",ps,[s[62]||(s[62]=e("strong",null,"Max Restart:",-1)),v(" "+n(t.haConfig.max_restart),1)]),e("div",gs,[s[63]||(s[63]=e("strong",null,"Max Relocate:",-1)),v(" "+n(t.haConfig.max_relocate),1)])]),t.applying?(l(),a("div",ms,[...s[65]||(s[65]=[e("div",{class:"spinner"},null,-1),e("p",null,"Applying HA configuration...",-1)])])):u("",!0),t.applyResult?(l(),a("div",fs,[t.applyResult.success?(l(),a("div",ys,[s[66]||(s[66]=e("span",{class:"icon"},"âœ“",-1)),s[67]||(s[67]=e("p",null,"High Availability configuration applied successfully!",-1)),t.applyResult.details&&t.applyResult.details.length>0?(l(),a("ul",bs,[(l(!0),a(G,null,N(t.applyResult.details,(o,r)=>(l(),a("li",{key:r},n(o),1))),128))])):u("",!0)])):u("",!0),t.applyResult.error?(l(),a("div",hs,[s[68]||(s[68]=e("span",{class:"icon"},"âœ•",-1)),e("p",null,n(t.applyResult.error),1)])):u("",!0)])):u("",!0)])):u("",!0)]),e("div",ks,[t.currentStep>0&&!t.applying?(l(),a("button",{key:0,onClick:s[14]||(s[14]=(...o)=>t.previousStep&&t.previousStep(...o)),class:"btn btn-secondary"}," Previous ")):u("",!0),t.currentStep<t.steps.length-1?(l(),a("button",{key:1,onClick:s[15]||(s[15]=(...o)=>t.nextStep&&t.nextStep(...o)),class:"btn btn-primary",disabled:!t.canProceed}," Next ",8,ws)):u("",!0),t.currentStep===t.steps.length-1&&!t.applyResult?(l(),a("button",{key:2,onClick:s[16]||(s[16]=(...o)=>t.applyConfiguration&&t.applyConfiguration(...o)),class:"btn btn-success",disabled:t.applying||!t.canApply},n(t.applying?"Applying...":"Apply Configuration"),9,xs)):u("",!0),t.applyResult&&t.applyResult.success?(l(),a("button",{key:3,onClick:s[17]||(s[17]=(...o)=>t.close&&t.close(...o)),class:"btn btn-primary"}," Done ")):u("",!0)])])])):u("",!0)])}const As=Q(re,[["render",Ms],["__scopeId","data-v-4e83599b"]]),Hs={name:"HAManagement",components:{HAWizard:As},setup(){const q=d([]),s=d([]),V=d({}),t=d(!1),M=d(!1),b=d(!1),o=d(null),r=d(null),R=d(null),F=d(!1),S=async()=>{var g,h;t.value=!0,o.value=null;try{const c=await y.ha.listGroups();q.value=c.data.groups||[]}catch(c){o.value=((h=(g=c.response)==null?void 0:g.data)==null?void 0:h.detail)||"Failed to load HA groups",console.error("Error loading HA groups:",c)}finally{t.value=!1}},z=async()=>{var g,h;M.value=!0,r.value=null;try{const c=await y.ha.listResources();s.value=c.data.resources||[]}catch(c){r.value=((h=(g=c.response)==null?void 0:g.data)==null?void 0:h.detail)||"Failed to load HA resources",console.error("Error loading HA resources:",c)}finally{M.value=!1}},_=async()=>{var g,h;b.value=!0,R.value=null;try{const c=await y.ha.checkStatus();V.value=c.data||{}}catch(c){R.value=((h=(g=c.response)==null?void 0:g.data)==null?void 0:h.detail)||"Failed to load HA status",console.error("Error loading HA status:",c)}finally{b.value=!1}},U=g=>({started:"badge-success",stopped:"badge-error",enabled:"badge-success",disabled:"badge-warning"})[g]||"badge-secondary",k=()=>{S(),z(),_()};return ne(()=>{S(),z(),_()}),{haGroups:q,haResources:s,haStatus:V,loading:t,loadingResources:M,loadingStatus:b,error:o,resourceError:r,statusError:R,showWizard:F,loadHAGroups:S,loadHAResources:z,loadHAStatus:_,getStatusClass:U,onWizardComplete:k}}},Vs={class:"ha-management"},Rs={class:"page-header"},Ss={class:"ha-content"},_s={class:"card"},Cs={class:"card-header"},Gs={key:0,class:"loading"},Ns={key:1,class:"error-message"},qs={key:2,class:"empty-state"},zs={key:3,class:"table-responsive"},Ps={class:"data-table"},Us={class:"card"},Es={class:"card-header"},Fs={key:0,class:"loading"},Ds={key:1,class:"error-message"},Ws={key:2,class:"empty-state"},Is={key:3,class:"table-responsive"},Ts={class:"data-table"},Bs={class:"card"},Ls={class:"card-header"},Os={key:0,class:"loading"},js={key:1,class:"error-message"},Qs={key:2,class:"status-grid"},Ys={class:"status-item"},Ks={class:"status-value"},Js={class:"status-item"},Xs={class:"status-value"},Zs={class:"status-item"},$s={class:"status-value"},et={class:"status-item"},st={class:"status-value"};function tt(q,s,V,t,M,b){const o=oe("HAWizard");return l(),a("div",Vs,[e("div",Rs,[s[6]||(s[6]=e("div",null,[e("h1",null,"High Availability Management"),e("p",{class:"subtitle"},"Manage Proxmox HA groups and resources")],-1)),e("button",{onClick:s[0]||(s[0]=r=>t.showWizard=!0),class:"btn btn-primary btn-wizard"},[...s[5]||(s[5]=[e("span",{class:"icon"},"âœ¨",-1),v(" Setup Wizard ",-1)])])]),e("div",Ss,[e("div",_s,[e("div",Cs,[s[8]||(s[8]=e("h2",null,"HA Groups",-1)),e("button",{onClick:s[1]||(s[1]=(...r)=>t.loadHAGroups&&t.loadHAGroups(...r)),class:"btn btn-secondary"},[...s[7]||(s[7]=[e("span",{class:"icon"},"ðŸ”„",-1),v(" Refresh ",-1)])])]),t.loading?(l(),a("div",Gs,"Loading HA groups...")):t.error?(l(),a("div",Ns,n(t.error),1)):t.haGroups.length===0?(l(),a("div",qs,[...s[9]||(s[9]=[e("p",null,"No HA groups configured",-1),e("p",{class:"help-text"},"HA groups define which nodes VMs can fail over to",-1)])])):(l(),a("div",zs,[e("table",Ps,[s[10]||(s[10]=e("thead",null,[e("tr",null,[e("th",null,"Group ID"),e("th",null,"Nodes"),e("th",null,"Restricted"),e("th",null,"No Failback"),e("th",null,"Comment")])],-1)),e("tbody",null,[(l(!0),a(G,null,N(t.haGroups,r=>(l(),a("tr",{key:r.group},[e("td",null,[e("strong",null,n(r.group),1)]),e("td",null,n(r.nodes),1),e("td",null,n(r.restricted?"Yes":"No"),1),e("td",null,n(r.nofailback?"Yes":"No"),1),e("td",null,n(r.comment||"-"),1)]))),128))])])]))]),e("div",Us,[e("div",Es,[s[12]||(s[12]=e("h2",null,"HA Resources",-1)),e("button",{onClick:s[2]||(s[2]=(...r)=>t.loadHAResources&&t.loadHAResources(...r)),class:"btn btn-secondary"},[...s[11]||(s[11]=[e("span",{class:"icon"},"ðŸ”„",-1),v(" Refresh ",-1)])])]),t.loadingResources?(l(),a("div",Fs,"Loading HA resources...")):t.resourceError?(l(),a("div",Ds,n(t.resourceError),1)):t.haResources.length===0?(l(),a("div",Ws,[...s[13]||(s[13]=[e("p",null,"No HA resources configured",-1),e("p",{class:"help-text"},"Add VMs to HA protection to enable automatic failover",-1)])])):(l(),a("div",Is,[e("table",Ts,[s[14]||(s[14]=e("thead",null,[e("tr",null,[e("th",null,"Resource ID"),e("th",null,"Type"),e("th",null,"Group"),e("th",null,"State"),e("th",null,"Max Restart"),e("th",null,"Max Relocate")])],-1)),e("tbody",null,[(l(!0),a(G,null,N(t.haResources,r=>(l(),a("tr",{key:r.sid},[e("td",null,[e("strong",null,n(r.sid),1)]),e("td",null,n(r.type||"VM"),1),e("td",null,n(r.group||"-"),1),e("td",null,[e("span",{class:H(["badge",t.getStatusClass(r.state)])},n(r.state),3)]),e("td",null,n(r.max_restart),1),e("td",null,n(r.max_relocate),1)]))),128))])])]))]),e("div",Bs,[e("div",Ls,[s[16]||(s[16]=e("h2",null,"HA Status",-1)),e("button",{onClick:s[3]||(s[3]=(...r)=>t.loadHAStatus&&t.loadHAStatus(...r)),class:"btn btn-secondary"},[...s[15]||(s[15]=[e("span",{class:"icon"},"ðŸ”„",-1),v(" Refresh ",-1)])])]),t.loadingStatus?(l(),a("div",Os,"Loading HA status...")):t.statusError?(l(),a("div",js,n(t.statusError),1)):(l(),a("div",Qs,[e("div",Ys,[s[17]||(s[17]=e("div",{class:"status-label"},"Manager Status",-1)),e("div",Ks,[e("span",{class:H(["badge",t.haStatus.manager_status==="active"?"badge-success":"badge-error"])},n(t.haStatus.manager_status||"Unknown"),3)])]),e("div",Js,[s[18]||(s[18]=e("div",{class:"status-label"},"Quorum",-1)),e("div",Xs,[e("span",{class:H(["badge",t.haStatus.quorum?"badge-success":"badge-error"])},n(t.haStatus.quorum?"OK":"Lost"),3)])]),e("div",Zs,[s[19]||(s[19]=e("div",{class:"status-label"},"Total Resources",-1)),e("div",$s,n(t.haResources.length),1)]),e("div",et,[s[20]||(s[20]=e("div",{class:"status-label"},"Total Groups",-1)),e("div",st,n(t.haGroups.length),1)])]))]),s[21]||(s[21]=ae('<div class="card help-card" data-v-1497c293><h3 data-v-1497c293>About High Availability</h3><p data-v-1497c293> Proxmox HA allows automatic failover of VMs between cluster nodes. When a node fails, VMs are automatically restarted on other available nodes in the HA group. </p><ul data-v-1497c293><li data-v-1497c293><strong data-v-1497c293>HA Groups:</strong> Define which nodes VMs can run on</li><li data-v-1497c293><strong data-v-1497c293>HA Resources:</strong> VMs that are protected by HA</li><li data-v-1497c293><strong data-v-1497c293>Manager Status:</strong> Shows if the HA manager service is running</li></ul><p class="help-text" data-v-1497c293> Configure HA groups and resources using the Proxmox web interface or command line. This page provides read-only monitoring of your HA configuration. </p></div>',1))]),le(o,{isOpen:t.showWizard,onClose:s[4]||(s[4]=r=>t.showWizard=!1),onComplete:t.onWizardComplete},null,8,["isOpen","onComplete"])])}const it=Q(Hs,[["render",tt],["__scopeId","data-v-1497c293"]]);export{it as default};
